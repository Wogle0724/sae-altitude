:root{
  --bg:#0b0f19;
  --card:#dff5ff;
  --text:#f5f7ff;
  --accent:#8fd3ff;
  --good:#8bffb5;
  --bad:#ff6b6b;
  --navy:#528494;
  --light:#71acc2;
  --brown:#e7decf;
}

*{box-sizing:border-box}
html,body{
  height:100%;
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
  overflow:hidden; /* keep scene immersive */
}

/* ---------- Scene ---------- */
#stage{
  position:fixed;
  inset:0;
  overflow:hidden;
}

/* Full-bleed background image container */
#bg{
  position:absolute;
  inset:0;
  background-image: url('assets/background.svg');
  background-size: cover;
  background-position: 70% center;
  background-repeat: no-repeat;
  z-index:2;
  overflow:hidden;
}

 
.skier-svg{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  z-index:2;
  pointer-events:none;
  overflow: visible;
  opacity: 0;
  transition: none;
}

.skier-svg.visible{ opacity: 1; }


/* ---------- Quiz ---------- */
#quiz{
  position:fixed;
  inset:0;
  display:grid;
  place-items:center;
  z-index:4;
  transition: opacity .5s ease, visibility .5s ease;
}
#quiz.hidden{
  opacity:0;
  visibility:hidden;
}

 .quiz-card{
   width:min(720px, 92vw);
   background: radial-gradient(circle at top left, rgba(255,255,255,0.35) 0%, rgba(230,245,255,0.25) 40%, rgba(200,230,255,0.18) 100%);
   backdrop-filter: blur(10px);
   border: 1px solid rgba(255,255,255,.3);
   border-radius: 16px;
   padding: 28px 24px;
   appearance: hidden;
 }

 .quiz-card h1{
   margin: 0 0 20px;
   font-weight: 700;
   line-height: 1.15;
   letter-spacing: .4px;
   text-align: center;
   color: #e8f8ff;
 }

.options{
  display:grid;
  grid-template-columns: repeat(2, minmax(0,1fr));
  gap:12px;
  margin-top:10px;
}
  .option{
   appearance:none;
   border:1px solid rgba(255,255,255,.25);
   background: rgba(240,250,255,0.45);
   color:#e6f7ff;
   padding:14px 16px;
   border-radius:12px;
   font-size:16px;
   cursor:pointer;
   transition: transform .08s ease, border-color .2s ease, background .2s ease, color .2s ease, box-shadow .2s ease;
 }

/* Make the correct answer (ALTITUDE) use the script stack even without extra class */
.options button[data-correct="true"]{
  font-family: "monte-stella-turbo", sans-serif;
  font-size: 1.3em;
  padding: 0;
}
 .option:hover{
   transform: translateY(-1px);
   border-color: rgba(255,255,255,.6);
   box-shadow: 0 0 16px rgba(180,240,255,.4);
 }
 .option.correct{
   background: linear-gradient(180deg, rgba(180,255,220,0.6), rgba(100,220,180,0.3));
   border-color: rgba(160,255,210,.8);
   color: #e9fff2;
   box-shadow: 0 0 18px rgba(160,255,210,.4);
 }
 .option.wrong{
   background: linear-gradient(180deg, rgba(255,180,180,0.5), rgba(255,120,120,0.3));
   border-color: rgba(255,180,180,.6);
   color: #ffeaea;
   box-shadow: 0 0 14px rgba(255,160,160,.3);
 }
.shake{
  animation: shake .35s ease;
}

 .hint{
   margin: 14px 2px 0;
   text-align: center;
   opacity: .85;
   font-size: 14px;
   color: #d9f2ff;
 }

/* ---------- Answer badge (after correct) ---------- */
#answer-badge{
  position:fixed;
  top:14px;
  left:50%;
  transform: translateX(-50%) scale(.9);
  z-index:4;
  color: var(--navy);
  border-radius: 999px;
  padding:10px 16px;
  font-weight:700;
  letter-spacing:.2px;
  opacity:0;
  pointer-events:none;
  transition: transform .5s ease; /* opacity will be handled by glitch if used */
}
#answer-badge.visible{
  opacity:1;
  transform: translateX(-50%) scale(1);
}

/* ---------- Answer float animation ---------- */
.answer-float{
  position: fixed;
  z-index: 5; /* above quiz */
  padding: 10px 16px;
  border-radius: 999px;
  font-weight: 800;
  letter-spacing: .2px;
  background: #10192ded;
  color: var(--good);
  border: 1px solid #2dd07e66;
  box-shadow: 0 12px 40px rgba(0,0,0,.45);
  will-change: transform, top, left, width, height, opacity;
  transition: top .6s ease, left .6s ease, transform .6s ease, width .6s ease, height .6s ease, opacity .6s ease;
  pointer-events: none;
}
.answer-float.to-top{
  top: 14px !important;
  left: 50% !important;
  transform: translateX(-50%) scale(1.6);
  width: auto !important;
  height: auto !important;
}

/* ---------- Info (typed content) ---------- */
#info{
  position: static;          /* let the parent flex container size to it */
  opacity:0;
  transition: none;
  background: none;          /* no panel */
  padding: 0;                /* spacing handled by #altitude-container gap */
  max-width: 60ch;           /* optional: keep readable line length */
  width: 100%;
  color: var(--navy);
  font-family: "fira-code", sans-serif;
  font-weight: 700;
  font-style: normal;
  text-shadow: none !important;
}
#info.visible{ opacity:1; }


/* ---------- Altitude container ---------- */
/* Use grid so title/date/guest overlap perfectly in the same spot */
#altitude-container{
  position: fixed;
  top: 50%;
  left: 50%;
  right: auto;
  bottom: auto;
  z-index: 10;
  display: grid;               /* stack all child elements in same grid cell */
  place-items: center;         /* center both horizontally & vertically */
  text-align: center;
  padding: 0;
  opacity: 0;
  transform: translate(-50%, -50%);
  transition: top .6s ease, left .6s ease, transform .6s ease;
  pointer-events: none;
  width: min(92vw, 1200px);
  max-width: min(92vw, 1200px);
  max-height: 100vh;
  overflow: visible;
  container-type: inline-size;
  align-items: center;
  justify-content: center;
  text-align: center;
  gap: 8px;
}

/* Make all 3 headline elements share the same centered position */
#altitude-title,
#altitude-date,
#altitude-guest{
  grid-area: 1 / 1;           /* occupy the same cell */
  justify-self: center;
  align-self: center;
  margin: 0;                  /* remove vertical offset */
  text-shadow:
    0 0 0.04em rgba(255,255,255,.9),
    0 0 0.12em rgba(173,216,230,.8),
    0 0 0.35em rgba(143,211,255,.7);
}

/* While centered, give the title its own inline padding so letters never clip,
   without changing the container's box (prevents horizontal jump on dock). */
#altitude-container:not(.dock) #altitude-title{
  padding-inline: clamp(20px, 5vw, 60px);
  transition: margin 1s ease, padding 1s ease;
}
#altitude-container.visible{
  opacity: 1;
  pointer-events: auto; 
}
/* Docked state: move whole container to top-left with padding */
#altitude-container.dock{
  top: 0;
  left: 0;
  transform: translate(0, 0);
  padding: 0;                  /* remove padding so the title isn't clipped */
  margin: clamp(16px, 4vh, 40px) clamp(20px, 5vw, 64px);
  align-items: flex-start;
  text-align: left;
}

/* ---------- Altitude title ---------- */
#altitude-title{
  font-family: "monte-stella-turbo", sans-serif;
  font-weight: 800;
  font-style: normal;
  /* Fallback: viewport-based size */
  font-size: clamp(32px, 9vw, 120px);
  line-height: 0.9;
  color: var(--text);
  letter-spacing: .02em;
  opacity: 0;
  transform: scale(0.85);
  transform-origin: center;
  transition: transform .6s ease, margin 1s ease, padding .6s ease;
  max-width: 100%;
  white-space: normal;
  text-wrap: balance;
  display: inline-block;
  margin: 0 auto;
}

/* Big date and guest use the same font and scale as the title */
#altitude-date,
#altitude-guest{
  font-family: "monte-stella-turbo", sans-serif;
  font-weight: 800;
  font-style: normal;
  /* Match the title's sizing */
  font-size: clamp(32px, 9vw, 120px);
  padding: 1em;
  line-height: 1;
  color: var(--text);
  letter-spacing: .02em;
  opacity: 0;
  transform: none;
  transform-origin: center;
  transition: opacity .6s ease;
  margin: 0;
  text-align: center;
  white-space: nowrap;    /* force single line */
  max-width: 100%;
  display: block;
  overflow: hidden;
  text-overflow: clip;
}
#altitude-date.show,
#altitude-guest.show{
  opacity: 1;
  transform: none;
}

@supports (font-size: 1cqi){
  /* Use the container inline-size to size the headline so it never overflows */
  #altitude-title{
    font-size: clamp(32px, 12cqi, 120px);
  }
  #altitude-date,
  #altitude-guest{
    font-size: clamp(32px, 12cqi, 120px);
  }
}
#altitude-title.show{ opacity: 1; transform: scale(1.2); }

/* When docked, align the title to the top-left and remove the center scale */
#altitude-container.dock #altitude-title{
  transform: scale(1);
  padding: 0;
  margin: 0;
}

/* ---------- Neon flicker/glitch in/out ---------- */
.neon-base{
  will-change: opacity, filter, text-shadow, transform;
  text-shadow:
    0 0 0.04em rgba(255,255,255,.9),
    0 0 0.12em rgba(173,216,230,.8),
    0 0 0.35em rgba(143,211,255,.7);
  filter: saturate(1.1);
}
@keyframes neon-flicker-in{
  0%   { opacity:0; filter:brightness(0.5); }
  5%   { opacity:1 }
  10%  { opacity:0 }
  18%  { opacity:1 }
  26%  { opacity:.2 }
  34%  { opacity:1 }
  42%  { opacity:.4 }
  50%  { opacity:1; filter:brightness(1.08) }
  58%  { opacity:.85 }
  66%  { opacity:1 }
  80%  { opacity:.95 }
  100% { opacity:1; filter:brightness(1) }
}
@keyframes neon-flicker-out{
  0%   { opacity:1; filter:brightness(1) }
  20%  { opacity:.4 }
  35%  { opacity:1 }
  55%  { opacity:.15 }
  70%  { opacity:.8 }
  85%  { opacity:.2 }
  100% { opacity:0; filter:brightness(.7) }
}
.neon-in{
  animation: neon-flicker-in 1.1s cubic-bezier(.22,.61,.36,1) both;
}
.neon-out{
  animation: neon-flicker-out .9s cubic-bezier(.22,.61,.36,1) both;
}
/* Respect reduced motion */
@media (prefers-reduced-motion: reduce){
  .neon-in, .neon-out{ animation-duration: .001s; }
}

/* Fade helpers for bg & snow */
.fadeable{
  opacity: 0;
  transition: none;
}
.fadeable.visible{ opacity: 1; }

/* ---------- Blackout overlay ---------- */
#blackout{
  position: fixed;
  inset: 0;
  background: #000;
  opacity: 0;
  transition: opacity .6s ease;
  z-index: 9; /* above everything during transition */
  pointer-events: none;
}
#blackout.visible{ opacity: 1; }

/* ---------- "SAE Presents" overlay ---------- */
#presents,
#intro-line{
  position: fixed;
  inset: 0;
  display: grid;
  place-items: center;
  z-index: 11;                /* above blackout */
  pointer-events: none;
  opacity: 0;
  /* allow neon effect without relying on opacity transition */
  transition: none;
  color: var(--text);
  text-align: center;
}
#intro-line{
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size: clamp(18px, 3.4vw, 32px);
  letter-spacing: 0.08em;
  text-transform: none;
  text-shadow: none;
  transition: opacity .8s ease;
}
#presents{
  font-family: "monte-stella-turbo", sans-serif;
  font-weight: 800;
  font-style: normal;
  font-size: clamp(28px, 6vw, 84px);
  letter-spacing: .02em;
}
#presents.visible,
#intro-line.visible{ opacity: 1; }

/* Full-screen ALTITUDE flash overlay (uses title font + presents glow) */
#altitude-flash{
  position: fixed;
  inset: 0;
  display: grid;
  place-items: center;
  z-index: 12; /* above blackout */
  pointer-events: none;
  opacity: 0;
  transition: none;
  font-family: "monte-stella-turbo", sans-serif;
  font-weight: 800;
  font-style: normal;
  font-size: clamp(36px, 9vw, 120px);
  letter-spacing: .02em;
  color: var(--text);
  text-align: center;
}
#altitude-flash.visible{ opacity: 1; }

/* Start snow paused; only run when we add .run on the wrapper */
/* default delay is 0s; both layers run simultaneously when .run is added */
#snow-wrap .snow-layer{
  animation-play-state: paused;
}
#snow-wrap.run .snow-layer{
  animation-play-state: running;
}

/* ---------- Keyframes ---------- */
@keyframes shake{
  0%{ transform: translateX(0) }
  20%{ transform: translateX(-6px) }
  40%{ transform: translateX(6px) }
  60%{ transform: translateX(-4px) }
  80%{ transform: translateX(4px) }
  100%{ transform: translateX(0) }
}

/* ---------- Responsive tweaks ---------- */
@media (max-width: 640px){
  .options{ grid-template-columns: 1fr; }
  #altitude-title,
  #altitude-date,
  #altitude-guest{
    transition: text-shadow .6s ease;
    transform: scale(1.2);
    text-shadow:
    0 0 6px rgba(255,255,255,.2),
    0 0 2px rgba(255,255,255,.40);
  }
  .skier-svg{
    transform: translateY(58vh) scale(1.15);
  }
  #presents{
    transform: scale(1.4);
  }
  #sky{
    width: 240vw; /* extra wide to avoid gaps on narrow viewports */
  }
  .options button[data-correct="true"]{
    padding: 10px;
  }
}

/* ---------- Seamless snowfall (two layers) ---------- */
#snow-wrap{
  position:absolute;
  inset:0;
  z-index:3;
  pointer-events:none;
  overflow:hidden;
}
.snow-layer{
  position:absolute;
  left:0;
  top:0;
  width:100%;
  height:100%;
  background-image: url('assets/snow.svg');
  background-size: cover;       /* fill the entire viewport without gaps */
  background-repeat: no-repeat;
  background-position: center top;
  animation: snow-loop 12s linear infinite;
  will-change: transform;
}
/* second layer starts mid-cycle so it is already moving */
#snow-wrap .snow-layer:nth-child(2){
  animation-delay: -6s; /* negative delay = begins halfway through immediately */
}
@keyframes snow-loop{
  0%   { transform: translateY(-100%); }  /* start above the screen */
  100% { transform: translateY(100%); }   /* end below the screen */
}

/* ===== Centered speaker overlay ===== */
#sound-overlay{
  position: fixed;
  inset: 0;
  display: grid;
  place-items: center;
  z-index: 100;           /* above all */
  pointer-events: none;   /* non-interactive */
  opacity: 0;
  transition: opacity .25s ease;
}
#sound-overlay.show{ opacity: 1; }
#sound-overlay svg{
  width: clamp(160px, 32vw, 360px);
  height: auto;
  color: #e6f7ff; /* currentColor for strokes/fills */
  filter: drop-shadow(0 0 12px rgba(230,247,255,.45));
}
#sound-overlay .spk{
  fill: currentColor;
  stroke: currentColor;
  stroke-width: .75;
}

#sound-overlay .bar{
  fill: none;
  stroke: currentColor;
  stroke-width: 2;
  stroke-linecap: round;
  stroke-linejoin: round;
  opacity: 0; /* default hidden */
}
/* Two-keyframe approach to get 0 bars -> 1 bar -> 2 bars, twice */
@keyframes speakerBars1 {
  0%{   opacity:0 }
  16%{  opacity:1 }  /* first cycle: show inner */
  33%{  opacity:1 }  /* first cycle: keep inner when outer shows */
  50%{  opacity:0 }  /* reset */
  66%{  opacity:1 }  /* second cycle: show inner */
  83%{  opacity:1 }  /* keep inner while outer shows */
  100%{ opacity:0 }  /* end hidden */
}
@keyframes speakerBars2 {
  0%{   opacity:0 }
  16%{  opacity:0 }  /* outer still hidden while inner shows */
  33%{  opacity:1 }  /* first cycle: show outer (2 bars) */
  50%{  opacity:0 }  /* reset */
  66%{  opacity:0 }  /* outer hidden while inner shows again */
  83%{  opacity:1 }  /* second cycle: show outer (2 bars) */
  100%{ opacity:0 }  /* end hidden */
}
/* When we add .play to the SVG, animate both bars once */
#sound-overlay .play .bar1{
  animation: speakerBars1 1.8s ease-out 0s 1 both;
}
#sound-overlay .play .bar2{
  animation: speakerBars2 1.8s ease-out 0s 1 both;
}

/* Optional utility: apply Zapfino (or similar) anywhere */
.zapfino{
  font-family: "Zapfino", "Apple Chancery", "Snell Roundhand", "Great Vibes", "Brush Script MT", "Segoe Script", cursive;
  line-height: 1.2;
  letter-spacing: 0.02em;
}